pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                 sh " git checkout ${version}"
                 sh "docker build --tag=node-app  ."
                 echo "samarrrrrrrrrrrrr"
            }
        }
        stage('push') {
            steps {
                 withCredentials([usernamePassword(credentialsId: 'docker', passwordVariable: 'DOCKER_REGISTRY_PWD', usernameVariable: 'DOCKER_REGISTRY_USER')]) {
                  sh 'docker login -u=$DOCKER_REGISTRY_USER -p=$DOCKER_REGISTRY_PWD'
                  sh 'docker tag node-app samargooda/node_project:latest'
                  sh "docker push samargooda/node_project:latest"
        }
    }
  }
 }
}